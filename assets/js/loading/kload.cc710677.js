/*
 * K-Load v2 (https://demo.maddela.org/k-load/).
 *
 * @link      https://www.maddela.org
 * @link      https://github.com/kanalumaddela/k-load-v2
 *
 * @author    kanalumaddela <git@maddela.org>
 * @copyright Copyright (c) 2018-2025 kanalumaddela
 * @license   MIT
 */const a=function(e,n,i){[].forEach.call(document.querySelectorAll(e),function(o){i?o.innerHTML=n:o.innerText=n})};var t={isGmod:navigator.userAgent.toLowerCase().indexOf("valve")!==-1,loadingHooks:{},events:{},data:{demoMode:!1,GameDetails:{},volume:15,files:{downloaded:0,needed:1,total:1,downloadComplete:!1}},finishedStatuses:["Sending client info...","Client info sent!","Received all Lua files we needed!","No files to request!","Starting Lua..."],tmp:{ignoreLoadings:!1,lastFileDownloaded:null,statuses:[],progressRegex:/(\d+)\/(\d+)/}};t.emit=function(e){if(typeof t.events[e]<"u"){const n=[].slice.call(arguments);n.shift(),t.events[e].forEach(function(i){i.apply(null,n)})}};t.on=function(e,n){typeof t.events[e]>"u"&&(t.events[e]=[]),t.events[e].push(n)};t.on("GameDetails",function(e,n,i,o,d,s,r,l){t.data.GameDetails.servername=e,t.data.GameDetails.serverurl=n,t.data.GameDetails.mapname=i,t.data.GameDetails.maxplayers=o,t.data.GameDetails.steamid=d,t.data.GameDetails.gamemode=s,t.data.GameDetails.volume=r,t.data.GameDetails.language=l,a(".server-name",e),a(".server-url",n),a(".map",i),a(".mapname",i),a(".max-players",o),a(".steamid",d),a(".gamemode",s),a(".volume",r),a(".language",l)});t.on("SetFilesTotal",function(e){t.data.files.total=e,a(".files-total",e)});t.on("SetFilesNeeded",function(e){t.data.files.needed=e,a(".files-needed",e)});t.getProgress=function(){const e=t.data.files.downloaded/t.data.files.needed;return{progress:t.data.files.downloadComplete?1:e,percentage:t.data.files.downloadComplete?100:Math.round(e*100)}};t.on("DownloadingFile",function(e){t.data.files.downloaded++,(t.data.files.needed<=0||t.data.files.downloaded>=t.data.files.needed)&&!t.data.demoMode&&SetFilesNeeded(t.data.files.downloaded+1),t.tmp.lastFileDownloaded=e,SetStatusChanged("Downloading "+e),a(".files-downloading",e),t.data.files.downloadComplete||t.emit("DownloadProgress",t.getProgress())});t.on("DownloadProgress",function(e){a(".files-downloaded",t.data.files.downloaded),a(".percentage",e.percentage+"%"),[].forEach.call(document.querySelectorAll(".loading-bar, .loading-bar--vertical"),function(n){n.classList.contains(".loading-bar--vertical")?n.style.height=e.percentage+"%":n.style.width=e.percentage+"%"})});t.on("SetStatusChanged",function(e){if(e.indexOf("Extracting")!==-1||e.indexOf("Retrieving")!==-1)return;const n=e.indexOf("Loading");n!==-1&&(e.indexOf(t.tmp.lastFileDownloaded)===-1&&(t.data.files.downloaded++,t.emit("DownloadProgress",t.getProgress())),e=e.substr(n)),a(".status",e),t.finishedStatuses.indexOf(e)!==-1&&(t.data.files.downloadComplete=!0,t.emit("DownloadProgress",{progress:1,percentage:100}))});t.init=function(){window.GameDetails=function(e,n,i,o,d,s,r,l){t.emit("GameDetails",e,n,i,o,d,s,r,l)},window.SetFilesTotal=function(e){t.emit("SetFilesTotal",e)},window.SetFilesNeeded=function(e){t.emit("SetFilesNeeded",e)},window.DownloadingFile=function(e){t.emit("DownloadingFile",e)},window.SetStatusChanged=function(e){t.emit("SetStatusChanged",e)}};t.Backgrounds={init:function(e,n){return this.setBackgrounds(e),this.setOptions(n),this.setupCss(),this.setupContainer(),this.data={currentIndex:-1,backgroundChildren:0,activeBackgrounds:[],timer:null},e&&e.length&&this.start(),this},start:function(){[].forEach.call(this.backgrounds,function(e){this.container.appendChild(this.createBackground(e))}.bind(this)),this.data.activeBackgrounds=this.backgrounds,this.data.backgroundChildren=this.container.querySelectorAll(".bg-item"),this.nextBackground(),this.data.timer=setInterval(function(){this.nextBackground()}.bind(this),this.options.duration)},nextBackground:function(){this.data.currentIndex++,this.data.currentIndex>=this.data.activeBackgrounds.length&&(this.data.currentIndex=0);const e=this.data.currentIndex;return this.data.backgroundChildren[e].style.opacity="1",e===0?this.data.backgroundChildren[this.data.activeBackgrounds.length-1].style.opacity="0":this.data.backgroundChildren[e-1].style.opacity="0",this},setupContainer:function(){return this.container=document.querySelector(".k-load-background-container"),this.container||(window.document.body.innerHTML+='<div class="k-load-background-container"></div>',this.container=document.querySelector(".k-load-background-container")),this},setupCss:function(){return window.document.body.innerHTML+="<style>body > .k-load-background-container {z-index: -9999;pointer-events: none;position: fixed;top: 0;left: 0;width: 100%;height: 100%;}.k-load-background-container > .bg-item {z-index: -9998;position: absolute;width: 100%;height: 100%;background-size: cover;background-position: center;opacity: 0;-webkit-transition: opacity "+Math.round(this.options.fade/1e3*100)/100+"s ease-in;}</style>",this},setBackgrounds:function(e){return e||(e=[]),this.backgrounds=e,this},getBackgrounds:function(){return this.backgrounds},createBackground:function(e){const n=document.createElement("div");return n.className="bg-item",n.style.backgroundImage="url("+e+")",n},setOptions:function(e){return e||(e={}),this.options={random:e.hasOwnProperty("random")?e.random:!0,fade:e.hasOwnProperty("fade")?e.fade:750,duration:e.hasOwnProperty("duration")?e.duration:5*1e3},this},getOptions:function(){return this.options}};
